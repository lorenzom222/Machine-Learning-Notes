## Gaussian Mixture

- Assumpution that are data is generated by a mixture (combination of probabilty distrubtions) of several Gaussian (or normal) distrubtions

Observed data likelihood function:
- Gaussian Mixture Distrubtion (linear superpostion of Gaussians)

$p(x)$ = sum of normal distrubutions times weight coefficient($\pi_k$)

Constraints:
- $0 \leq \pi_k \geq 1$

- sum of weight coeff for all clusters  = 1


### Properties

Gaussian component: One component is a Gaussian distrubtion that make up the mixture model. Similar to Clusters.
- Compenent is active when $z_k = 1$
- Ex. $[0,1,0]$: Here $z_2$ is active for the observing data point 
- HOWEVER, we do not have access to the one-hot vector so we need a different approach. Softer approach.


$\boldsymbol{z}$ (latent or inferred variable with $K$ space): Represent the component from which each data point is drawn
- Each data point in the dataset has its own value of z that indicates which component it was drawn from
- Ex. When $z_2 = 1$, that means for that data point it's assumed that is was generated from the 2nd component.
- Binary vector with $K$ elements, where each element can be either 0 or 1.
- 1-of-K representation, if an element ($z_k$) of $\boldsymbol{z}$ is 1 then it belongs to the k-th cluster.
- This act somewhat like a key to the ideal solution.
- We want to achieve a $\boldsymbol{z}$ what maximizes the likelihood.

$z_k$ (binary indicator): Indicate which component is active for a given data point. 
- ($z_{k} ∈ {0,1}$)
- $\sum_k z_k = 1$ or the sum of all $z_k$ elements in $\boldsymbol{z}$ is 1


$\boldsymbol{\pi}$ Mixing Vector: Contains the mixing coefficent corresponding to each cluster.
- $\boldsymbol{\pi} = [\pi_1,... ,\pi_k]$
- $0 \leq \pi_k \geq 1$
- $\sum_K \pi_k = 1$

$\pi_k$ Mixture Coefficient: Represent the prior probabilities of each component being active.
- Defines the porportion of each compenent in the mixture.
- init: Randomly or Equally chosen
- Goal: Determine the proportions of each component in the mixture
- Ex: 
	- 2 components in the mixture 
	- Mixing coefficients are 0.6 and 0.4, 
	- This means that on average, 60% of the data points are drawn from the first component and 40% of the data points are drawn from the second component.


### Graphical Model
- Marginal-distrubution: $p(\boldsymbol{z})$
	- Probability of a particular element $z_k$ being equal to 1 is given by the value of the corresponding mixing coefficient $\pi_k$
	- $p(\boldsymbol{z}) =$ product of all $\pi_k$ in $pi$ raised to the power of the corresponding element of $\boldsymbol{z}$.
$p(\boldsymbol{z}) = \prod_k \pi_k^{z_k}$

	- So if $z_2 = 1$ for some data point, $\pi_2 = p(z_2)$
	- Each data point do not exclusively belong to a certain component, but to all of them with different probability
	- Ex. if there are three components in the mixture and the mixing coefficients are $[0.2, 0.5, 0.3]$, then the probability of $z$ being equal to $[0, 1, 0]$ is $p(z=[0,1,0]) = 0.2^0 * 0.5^1 * 0.3^0 = 0.5$
	- This is a way of selecting the right value for the corresponding $z$ to $\pi$
- Conditional-distrubution: $p(\boldsymbol{x}|\boldsymbol{z})$ is equal to the product normal distrubtion raised to the power of the corresponding element of $\boldsymbol{z}$ ($z_k$). Similar to the marginal-distrubution, this is a way of selecting the corresponding distrubtions to a data point.
	- Given we have $\boldsymbol{z}$ what's the probabilty of $\boldsymbol{x}$



- Joint-distrubution: $p(\boldsymbol{x}, \boldsymbol{z}) = p(\boldsymbol{z})p(\boldsymbol{x}|\boldsymbol{z})$ 

Z ---> X


## Likelihood Function

### Sample
The marginal distribution for a *sample* being a single observation ($\boldsymbol{x}$) is the sum of the joint distrubtions over all possible states of $\boldsymbol{z}$.

$p(\boldsymbol{x}) = \sum_z p(\boldsymbol{z})p(\boldsymbol{x|z})$

We can combine the distrubtion of a particular $\boldsymbol{z}$ and the conditional distribution of $\boldsymbol{x}$ given the particular value $\boldsymbol{z}$.
- $p(\boldsymbol{z}) = \prod_{k=1} \pi_k^{z_k}$
- $p(\boldsymbol{x|z})= \prod_{k=1} \mathcal{N}(\boldsymbol{x}|\boldsymbol{\mu_k}\boldsymbol{\Sigma}_k)$

$p(\boldsymbol{x}) = \prod_{k=1} \pi_k^{z_k}\mathcal{N}(\boldsymbol{x}|\boldsymbol{\mu_k}\boldsymbol{\Sigma}_k)$


### Whole dataset (1/2)
$\boldsymbol{X}$: $N \cdot D$ matrix of observations
- Each row represents a single observation ($N$) from the data
- Each colunm represents a singl feature or dimension ($D$) of the data

The data is assumed to be i.i.d (“independent and identically distributed”). 
- Meaning each data point is generated by one of the components and the probabilty of this being true is the mixing coefficient ($\pi_k$)

$\boldsymbol{Z}$: $N \cdot K$ matrix of inferred variables
- Each row represents the nth point's $z$
- Each colunumns represents different hidden or inferred variables ($z{^n}_k$)

Now we can sum over the $N$ observations along with (similar to the sample) the $K$ Gaussian compenents. And we can take it's log for good measure (not 100% why we do this, but for now I think it's because it makes the math easier):

$ln p(X|π,μ,Σ) = ∑_{n=1}^{N} ln { ∑_{k=1}^{K} π_k N(x_n|μ_k,Σ_k) }$

And a likelihood function but with issues...

## Maximum Likelihood with EM (2/2)
We can take the derivative of likelihood function with respect to each parameter one at a time to evalute the posterior probablitites or "responsibilty".

1. Take derivate of the likelihood function with respect to the means $μ_k$ of the Gaussian components of the mixture model and set to 0.
	- This is because the mean key parameter that affects the overall behavior of the system
	- The mean represents the center of each Gaussian component, which controls the location of the mode and the spread of the distribution. (Similar to the centroid in K-means)
	- We can then solve for optimal means $μ_k$ rather than our random ones


## EM Algorithm for Gaussion
Goal: *Mamimize the likelihood function with respect to the params (mean, covariance, mixing)*

1. Init: initialize params to some value
2. E-step: Evaluate the responsibilites using the current params
3. M-Step: Re-estimate the params using the responsibilites you got from 2
4. Check if converged{break if yes, return to 2 otherwise}




## References

- Bishop Chapter 9
- https://mpatacchiola.github.io/blog/2020/07/31/gaussian-mixture-models.html
- https://web.stanford.edu/~lmackey/stats306b/doc/stats306b-spring14-lecture2_scribed.pdf
- https://machine-learning-upenn.github.io/assets/notes/Lec13_Updated.pdf






